import sys
from itertools import cycle

_map = []  # the full map
guard_cur = ()  # the current pos of the guard
dirs_pos = {'s': (1, 0), 'n': (-1, 0), 'w': (0, -1),'e': (0, 1)}  # welke bewegingen gedaan moeten worden voor elke windricthing
dirs = cycle(['n', 'e', 's', 'w'])  # Wrapping iterator voor alle windrichtingen
dir_cur = dirs.__next__()
containing_loop = 0
loop_obstacles = []
steps = 0

# Posities van nieuwe obstakels
# test input
# [(6,3), (8,1), (8,3), (7,6), (7,7),  (9,7)]
# echte input
# [(45, 83), (48, 83), (49, 66), (49, 55), (34, 63), (34, 84), (42, 97), (51, 97), (53, 97), (57, 97), (71, 97), (75, 94), (75, 85), (75, 77), (75, 70), (75, 61), (75, 45), (60, 56), (60, 66), (60, 68), (60, 72), (64, 95), (79, 95), (94, 95), (110, 63), (77, 62), (44, 85), (44, 87), (44, 99), (53, 104), (55, 104), (57, 104), (65, 94), (65, 85), (65, 75), (65, 66), (65, 63), (65, 61), (59, 53), (33, 53), (33, 57), (33, 58), (33, 63), (33, 65), (33, 76), (33, 84), (33, 96), (33, 98), (35, 100), (42, 100), (51, 100), (53, 100), (55, 100), (57, 100), (67, 100), (72, 100), (75, 100), (79, 100), (87, 100), (105, 94), (105, 60), (105, 57), (105, 53), (105, 51), (105, 46), (104, 46), (99, 46), (93, 46), (74, 52), (74, 55), (74, 67), (74, 77), (74, 96), (74, 98), (76, 98), (79, 98), (84, 91), (84, 85), (84, 83), (84, 81), (84, 72), (84, 70), (84, 65), (83, 59), (58, 59), (43, 59), (29, 59), (29, 63), (29, 65), (29, 76), (29, 85), (29, 87), (29, 96), (29, 98), (36, 111), (42, 111), (51, 111), (53, 111), (55, 111), (57, 111), (61, 111), (71, 111), (73, 111), (75, 111), (85, 111), (88, 109), (88, 102), (88, 101), (88, 99), (88, 97), (88, 91), (88, 85), (88, 83), (88, 79), (88, 72), (88, 70), (88, 65), (88, 45), (88, 40), (88, 38), (88, 32), (88, 28), (88, 26), (86, 26), (84, 26), (75, 26), (73, 26), (67, 26), (59, 26), (41, 26), (33, 26), (28, 26), (28, 28), (31, 25), (30, 24), (28, 24), (18, 28), (18, 44), (18, 58), (18, 59), (18, 66), (18, 76), (30, 78), (35, 78), (36, 78), (45, 78), (48, 78), (50, 78), (53, 66), (53, 58), (53, 57), (53, 55), (53, 52), (53, 47), (53, 40), (53, 31), (53, 25), (53, 24), (53, 23), (50, 22), (41, 22), (33, 22), (30, 22), (28, 22), (27, 22), (17, 22), (13, 22), (13, 28), (13, 36), (13, 44), (13, 58), (13, 59), (13, 66), (14, 67), (30, 67), (32, 67), (35, 67), (36, 67), (39, 67), (48, 67), (50, 67), (52, 67), (55, 67), (57, 67), (66, 67), (67, 67), (74, 67), (76, 67), (83, 67), (85, 67), (85, 66), (85, 58), (85, 57), (85, 55), (85, 45), (85, 40), (85, 38), (85, 32), (85, 28), (85, 22), (85, 13), (85, 9), (84, 7), (62, 7), (59, 7), (50, 9), (50, 12), (50, 18), (50, 20), (50, 22), (50, 23), (50, 27), (50, 28), (50, 32), (50, 34), (50, 35), (50, 52), (52, 55), (53, 55), (54, 55), (57, 55), (58, 55), (62, 55), (66, 55), (74, 55), (76, 55), (77, 55), (83, 55), (85, 55), (86, 55), (86, 45), (86, 40), (86, 38), (86, 32), (86, 28), (86, 26), (86, 22), (85, 20), (84, 20), (75, 20), (73, 20), (63, 20), (59, 20), (55, 20), (53, 20), (49, 20), (47, 20), (46, 20), (46, 23), (46, 26), (46, 27), (46, 28), (46, 32), (46, 34), (46, 52), (46, 53), (46, 56), (46, 58), (46, 59), (46, 60), (46, 61), (46, 64), (46, 66), (46, 73), (46, 74), (46, 75), (46, 76), (46, 84), (48, 90), (50, 90), (51, 90), (53, 90), (57, 90), (66, 90), (67, 90), (71, 90), (72, 90), (76, 90), (85, 90), (86, 90), (87, 90), (96, 70), (96, 65), (96, 40), (96, 38), (96, 30), (93, 28), (85, 28), (75, 28), (73, 28), (67, 28), (59, 28), (50, 28), (48, 28), (47, 28), (46, 28), (44, 28), (43, 32), (43, 34), (45, 49), (48, 49), (52, 49), (54, 49), (57, 49), (58, 49), (59, 49), (62, 49), (74, 49), (76, 49), (83, 49), (87, 49), (90, 49), (93, 49), (93, 45), (93, 40), (93, 38), (93, 32), (93, 30), (93, 27), (93, 22), (93, 19), (93, 16), (84, 15), (78, 15), (75, 15), (73, 15), (63, 15), (59, 15), (59, 18), (67, 18), (69, 18), (84, 18), (86, 18), (87, 18), (91, 18), (96, 16), (96, 6), (91, 18), (91, 20), (91, 24), (91, 25), (91, 34), (91, 37), (91, 45), (91, 50), (91, 52), (93, 54), (97, 54), (109, 54), (111, 54), (112, 53), (112, 51), (112, 47), (112, 45), (112, 44), (112, 40), (112, 22), (112, 19), (109, 30), (110, 23), (110, 19), (110, 16), (90, 9), (85, 9), (84, 9), (78, 9), (75, 9), (73, 9), (71, 9), (67, 9), (65, 12), (65, 13), (65, 26), (65, 27), (65, 28), (65, 29), (65, 32), (65, 35), (65, 36), (70, 43), (73, 43), (77, 43), (83, 43), (87, 43), (90, 43), (95, 43), (97, 43), (109, 43), (111, 43), (113, 43), (118, 43), (118, 37), (112, 37), (100, 37), (96, 37), (94, 37), (90, 37), (88, 37), (86, 37), (84, 37), (80, 37), (78, 37), (77, 37), (75, 37), (73, 37), (67, 37), (64, 37), (62, 44), (62, 49), (62, 51), (62, 52), (62, 56), (62, 64), (62, 73), (62, 75), (62, 76), (62, 78), (66, 80), (67, 80), (71, 80), (72, 80), (76, 80), (80, 79), (80, 77), (80, 72), (80, 70), (80, 66), (80, 64), (80, 63), (80, 61), (80, 58), (80, 54), (80, 53), (80, 45), (80, 40), (80, 38), (80, 36), (80, 33), (80, 32), (80, 30), (80, 27), (80, 24), (80, 23), (80, 21), (80, 19), (80, 17), (78, 17), (75, 17), (73, 17), (71, 17), (67, 17), (64, 17), (58, 17), (56, 17), (55, 17), (53, 17), (49, 17), (47, 17), (45, 17), (43, 17), (41, 17), (34, 17), (32, 17), (30, 17), (28, 17), (27, 17), (24, 17), (22, 18), (22, 28), (22, 32), (22, 34), (22, 36), (22, 44), (22, 50), (22, 57), (22, 58), (22, 59), (22, 61), (22, 62), (22, 63), (22, 66), (22, 68), (22, 72), (22, 74), (22, 76), (22, 79), (22, 84), (29, 87), (35, 87), (36, 87), (37, 87), (39, 87), (43, 87), (45, 87), (46, 87), (48, 87), (50, 87), (51, 87), (53, 87), (55, 87), (57, 87), (66, 87), (67, 87), (71, 87), (73, 87), (81, 87), (82, 87), (86, 87), (87, 87), (89, 85), (89, 83), (89, 79), (89, 72), (89, 70), (89, 65), (89, 64), (89, 63), (89, 61), (88, 61), (85, 61), (84, 61), (83, 61), (82, 61), (77, 61), (75, 61), (73, 61), (71, 61), (70, 61), (67, 61), (61, 61), (59, 61), (57, 61), (53, 61), (50, 61), (49, 61), (45, 61), (43, 61), (41, 65), (41, 66), (41, 73), (41, 74), (41, 75), (41, 76), (41, 82), (41, 85), (41, 91), (41, 96), (41, 98), (41, 101), (43, 101), (45, 101), (48, 101), (50, 101), (51, 101), (53, 101), (55, 101), (57, 101), (65, 101), (67, 101), (69, 99), (69, 85), (69, 83), (69, 81), (69, 79), (69, 75), (69, 71), (69, 66), (67, 66), (62, 66), (60, 66), (58, 66), (56, 66), (50, 66), (49, 66), (48, 67), (48, 73), (48, 74), (48, 75), (48, 76), (48, 78), (48, 84), (48, 88), (48, 90), (48, 96), (48, 98), (48, 102), (50, 102), (51, 102), (53, 102), (55, 102), (57, 102), (67, 102), (71, 102), (73, 102), (75, 102), (79, 102), (81, 102), (82, 102), (84, 102), (88, 102), (89, 102), (90, 102), (91, 94), (91, 91), (91, 85), (89, 85), (83, 85), (82, 85), (81, 85), (77, 85), (75, 85), (73, 85), (69, 85), (66, 85), (62, 85), (56, 85), (54, 85), (53, 85), (51, 85), (49, 85), (47, 85), (45, 85), (43, 85), (41, 85), (37, 85), (35, 85), (33, 85), (29, 85), (26, 85), (24, 85), (21, 85), (19, 85), (17, 85), (16, 88), (16, 90), (16, 98), (16, 100), (16, 101), (16, 104), (16, 105), (18, 107), (20, 107), (22, 107), (27, 107), (28, 107), (30, 107), (36, 107), (37, 107), (42, 107), (43, 107), (51, 107), (53, 107), (55, 107), (57, 107), (58, 107), (59, 107), (71, 107), (73, 107), (75, 107), (77, 103), (77, 101), (77, 99), (77, 91), (77, 89), (77, 85), (77, 83), (77, 81), (77, 79), (77, 77), (77, 69), (77, 66), (77, 64), (77, 63), (77, 61), (77, 59), (77, 58), (77, 55), (77, 54), (77, 53), (77, 45), (77, 42), (77, 40), (77, 38), (77, 36), (77, 33), (77, 32), (75, 32), (73, 32), (71, 32), (68, 32), (64, 32), (59, 32), (57, 32), (56, 32), (55, 34), (55, 35), (55, 39), (55, 44), (55, 50), (55, 52), (55, 56), (55, 65), (55, 68), (57, 68), (58, 68), (59, 68), (60, 68), (62, 68), (64, 68), (67, 68), (71, 68), (73, 68), (74, 68), (79, 68), (86, 68), (92, 68), (93, 68), (94, 68), (97, 68), (98, 68), (103, 64), (103, 63), (103, 61), (103, 60), (103, 57), (103, 53), (103, 47), (103, 45), (103, 42), (103, 40), (103, 38), (103, 36), (103, 27), (103, 24), (103, 22), (103, 21), (103, 19), (103, 16), (100, 13), (95, 13), (90, 13), (88, 13), (86, 13), (85, 13), (83, 13), (82, 13), (80, 13), (78, 13), (75, 13), (73, 13), (71, 13), (67, 13), (65, 13), (64, 13), (59, 13), (56, 13), (55, 13), (53, 13), (52, 17), (52, 20), (52, 24), (52, 32), (52, 34), (52, 35), (52, 39), (52, 40), (52, 44), (52, 46), (52, 49), (52, 51), (52, 52), (52, 55), (52, 56), (54, 56), (55, 56), (57, 56), (58, 56), (59, 56), (60, 56), (62, 56), (67, 56), (72, 56), (73, 56), (76, 56), (77, 56), (78, 56), (79, 56), (80, 56), (81, 56), (84, 56), (86, 56), (87, 56), (90, 56), (92, 56), (93, 56), (97, 56), (98, 56), (101, 50), (98, 45), (96, 45), (95, 45), (94, 45), (90, 45), (88, 45), (85, 45), (84, 45), (82, 45), (80, 45), (77, 45), (72, 45), (71, 45), (69, 45), (67, 45), (64, 45), (61, 45), (59, 45), (57, 45), (54, 45), (51, 45), (49, 45), (47, 45), (45, 45), (42, 45), (40, 45), (39, 45), (38, 45), (37, 45), (36, 45), (35, 45), (33, 45), (29, 45), (28, 45), (21, 45), (17, 45), (12, 45), (9, 46), (9, 47), (9, 51), (9, 55), (9, 58), (9, 59), (9, 61), (9, 68), (9, 72), (9, 74), (9, 76), (9, 79), (9, 84), (9, 87), (9, 89), (9, 100), (9, 101), (9, 104), (9, 105), (9, 107), (9, 110), (11, 113), (18, 113), (27, 113), (28, 113), (34, 113), (36, 113), (42, 113), (45, 105), (45, 101), (45, 98), (45, 96), (45, 94), (45, 91), (45, 89), (45, 87), (45, 85), (45, 83), (45, 81), (45, 79), (45, 70), (45, 68), (45, 66), (40, 65), (37, 65), (32, 65), (30, 65), (29, 65), (26, 65), (21, 65), (19, 65), (17, 65), (15, 65), (12, 65), (12, 68), (12, 72), (12, 74), (12, 76), (12, 79), (12, 84), (12, 87), (12, 89), (22, 93), (24, 93), (27, 93), (30, 93), (35, 93), (36, 93), (37, 93), (42, 93), (43, 93), (46, 93), (47, 93), (49, 93), (50, 93), (51, 93), (53, 93), (55, 93), (57, 93), (58, 93), (64, 93), (66, 93), (67, 93), (71, 93), (73, 93), (79, 93), (81, 93), (82, 93), (86, 93), (87, 93), (90, 93), (93, 93), (97, 93), (97, 91), (95, 91), (92, 91), (88, 91), (84, 91), (82, 91), (81, 91), (79, 93), (79, 95), (79, 96), (79, 98), (79, 100), (79, 102), (79, 104), (79, 107), (79, 115), (80, 117), (82, 117), (87, 117), (89, 117), (90, 117), (98, 117), (101, 117), (109, 117), (112, 117), (113, 107), (113, 106), (113, 103), (104, 98), (99, 98), (99, 101), (99, 107), (99, 108), (99, 111), (99, 112), (99, 114), (108, 114), (112, 114), (119, 108), (119, 106), (119, 103), (119, 97), (119, 90), (119, 87), (119, 84), (119, 79), (119, 75), (112, 75), (104, 75), (95, 75), (78, 75), (72, 75), (69, 75), (67, 75), (66, 75), (62, 75), (61, 75), (59, 75), (57, 75), (48, 75), (47, 75), (40, 75), (38, 75), (32, 75), (30, 75), (28, 75), (26, 75), (21, 75), (19, 75), (17, 75), (15, 75), (11, 75), (8, 75), (6, 75), (4, 75), (3, 76), (3, 79), (3, 84), (3, 87), (3, 89), (3, 94), (3, 100), (3, 101), (3, 107), (3, 110), (3, 114), (9, 120), (18, 120), (28, 120), (34, 120), (36, 120), (42, 120), (51, 120), (55, 120), (57, 120), (61, 120), (61, 113), (61, 111), (61, 109), (61, 105), (61, 99), (61, 94), (61, 89), (61, 85), (61, 83), (61, 82), (61, 78), (59, 78), (59, 82), (59, 83), (59, 85), (59, 87), (59, 89), (59, 90), (59, 92), (59, 94), (59, 96), (59, 98), (59, 100), (59, 102), (59, 104), (59, 105), (59, 107), (59, 109), (59, 110), (59, 111), (59, 115), (59, 120), (61, 122), (63, 122), (72, 122), (81, 122), (82, 122), (84, 122), (90, 122), (96, 122), (98, 117), (98, 107), (95, 107), (90, 107), (87, 111), (87, 112), (87, 114), (87, 115), (87, 117), (87, 123), (89, 125), (94, 125), (96, 125), (99, 125), (109, 125), (112, 125), (121, 107), (121, 106), (121, 103), (121, 97), (121, 96), (121, 91), (121, 87), (121, 84), (115, 95), (117, 95), (118, 95), (124, 94), (124, 90), (124, 87), (124, 84), (124, 83), (122, 84), (122, 95), (122, 96), (122, 100), (123, 115), (126, 108), (126, 106), (126, 103), (126, 97), (126, 96), (126, 93), (126, 91), (126, 87), (126, 84), (126, 83), (126, 82), (126, 79), (120, 77), (115, 77), (112, 77), (108, 77), (104, 77), (95, 77), (82, 77), (77, 77), (75, 77), (74, 77), (73, 77), (71, 79), (71, 80), (71, 81), (71, 83), (71, 87), (71, 89), (71, 90), (71, 91), (71, 93), (71, 95), (71, 97), (71, 99), (71, 101), (71, 103), (71, 107), (71, 109), (71, 110), (71, 111), (71, 115), (71, 116), (71, 117), (72, 118), (74, 118), (78, 117), (78, 113), (78, 111), (74, 109), (71, 109), (70, 109), (68, 109), (66, 109), (64, 109), (58, 109), (56, 109), (52, 109), (50, 109), (44, 110), (44, 115), (44, 117), (44, 119), (44, 121), (44, 123), (44, 127), (45, 128), (51, 128), (55, 128), (57, 128), (50, 124), (44, 124), (43, 124), (39, 124), (21, 127)]

def init(guard_cur = ()):

    obstacles = []
    with open("input.txt") as f:

        for x, line in enumerate(f):
            _map.append([])
            for y, char in enumerate(line.strip()):
                if char == '^':
                    guard_cur = (x,y)
                if char == '#':
                    obstacles.append((x,y))
                _map[x].append((x,y,char))
    return obstacles, guard_cur

# print("guard_start: ", guard_cur)
# print("dir_start: ", dir_cur)
# print("obstacles: ", obstacles)
print()

def part1(obstacles, guard_cur, guard_his = []):

    move_guard(obstacles, guard_cur, guard_his)
    print(guard_his)
    return len(set((x,y) for x,y,z in guard_his)), obstacles, guard_his


def move_guard(obstacles, guard_cur, guard_his, dir_org = None):
    # print(obstacles)
    # print((6,3) in obstacles)
    global dir_cur
    keep_going = True
    while keep_going:
        new_pos = (guard_cur[0] + dirs_pos[dir_cur][0], guard_cur[1] + dirs_pos[dir_cur][1])

        #End if you reach the limit of the map
        if new_pos[0] < 0 or new_pos[0] >= len(_map) or new_pos[1] < 0 or new_pos[1] >= len(_map):
            keep_going = False
            continue

        # Check of er een loop in zit (zou alleen in part 2 moeten gebeuren)
        if(contains_loop(new_pos, dir_cur, guard_his)):
            global loop_obstacles
            loop_obstacles.append(obstacles[-1])
            return guard_his

        # move until you reach an obstacle
        if new_pos not in obstacles:
            guard_cur = new_pos
            guard_his.append((new_pos[0], new_pos[1], dir_cur))

        # if you reach an obstacle, turn and start moving again
        else:
            dir_cur = dirs.__next__()
            move_guard(obstacles, guard_cur, guard_his)
            keep_going = False
    return guard_his



def part2(obstacles, guard_his, guard_cur):
    global containing_loop
    containing_loop = 0

    # Brute force: Zet op elke plek van het bewandelde pad (uit part1) een obstakel en kijk of de guard dan in een loop gaat lopen.
    for guard_his_idx, pos in enumerate(guard_his):
        new_guard_cur, new_guard_his = calc_new_guard(guard_cur, guard_his, guard_his_idx) #optimalisatie, zodat je niet elke keer het hele pad hoeft te bewandelen
        pos_temp = (pos[0], pos[1]) # zonder windrichting
        obstacles.append(pos_temp)
        dirs = cycle(['n', 'e', 's', 'w'])  # Iterator resetten
        global dir_cur
        dir_cur = dirs.__next__() # Reset de dir naar de startpositie 'n'
        guard_his_return = move_guard(obstacles, new_guard_cur, new_guard_his) # Laat de guard de ronde lopen met een extra obstakel

        obstacles.remove(pos_temp)

    return len(set(loop_obstacles))


def calc_new_guard(guard_cur, guard_his, guard_his_idx):
    # Zet de guard positie als 1 stap voor het object en bereken of je dan in een loop komt of niet.
    # Zet de guard his op de his voor deze stap
    # Zo hoef je niet elke keer het hele pad te berekenen
    new_guard_cur = guard_cur
    new_guard_his = []
    if guard_his_idx > 0:
        new_guard_cur = (guard_his[guard_his_idx - 1][0], guard_his[guard_his_idx - 1][1])
        new_guard_his.extend(guard_his[:guard_his_idx -1])
    return new_guard_cur, new_guard_his


def contains_loop(pos, dir, his):
    global containing_loop
    if (pos[0], pos[1], dir) in his:
        # print(f"({pos[0]}, {pos[1]}, {dir}) - {len(his)}")
        containing_loop += 1
        return True
    return False

def too_many_steps(guard_his):
    return len(guard_his) > 10000


obstacles, guard_cur = init()
len_his, obst, his = part1(obstacles, guard_cur)
print("The answer to part 1 = ", len_his)
part2_ans = part2(obstacles, his, guard_cur)
print("The answer to part 2 = ", part2_ans)
print(loop_obstacles)

# 1757 = too high
# 1175 = too low

# l = [(7, 75), (49, 74), (49, 66), (49, 65), (49, 60), (49, 55), (49, 47), (34, 49), (34, 57), (34, 66), (34, 76), (34, 85), (36, 97), (39, 97), (42, 97), (45, 97), (48, 97), (51, 97), (54, 97), (57, 97), (61, 97), (64, 97), (67, 97), (70, 97), (73, 97), (75, 96), (75, 85), (75, 77), (75, 75), (75, 61), (75, 57), (75, 37), (60, 36), (60, 49), (60, 56), (60, 66), (60, 67), (60, 68), (60, 72), (60, 75), (61, 95), (63, 95), (65, 95), (67, 95), (69, 95), (71, 95), (73, 95), (75, 95), (77, 95), (79, 95), (81, 95), (83, 95), (85, 95), (87, 95), (88, 95), (89, 95), (91, 95), (93, 95), (95, 95), (97, 95), (99, 95), (101, 95), (103, 95), (105, 95), (107, 95), (109, 95), (110, 94), (110, 76), (110, 64), (96, 62), (81, 62), (67, 62), (44, 66), (44, 76), (44, 85), (44, 96), (44, 98), (46, 104), (48, 104), (50, 104), (52, 104), (54, 104), (56, 104), (58, 104), (60, 104), (62, 104), (64, 104), (65, 103), (65, 102), (65, 96), (65, 94), (65, 85), (65, 77), (65, 75), (65, 70), (65, 66), (65, 63), (65, 62), (65, 61), (33, 57), (33, 63), (33, 65), (33, 66), (33, 69), (33, 75), (33, 76), (33, 85), (33, 96), (33, 98), (33, 100), (35, 100), (37, 100), (39, 100), (41, 100), (43, 100), (45, 100), (47, 100), (49, 100), (51, 100), (53, 100), (55, 100), (57, 100), (59, 100), (61, 100), (63, 100), (65, 100), (67, 100), (69, 100), (71, 100), (73, 100), (75, 100), (77, 100), (79, 100), (81, 100), (83, 100), (85, 100), (87, 100), (89, 100), (91, 100), (93, 100), (95, 100), (97, 100), (99, 100), (101, 100), (103, 100), (105, 100), (105, 95), (105, 94), (105, 76), (105, 75), (105, 67), (105, 61), (105, 60), (105, 55), (105, 52), (105, 51), (105, 49), (105, 47), (104, 46), (81, 46), (74, 49), (74, 52), (74, 55), (74, 56), (74, 58), (74, 59), (74, 63), (74, 67), (74, 68), (74, 76), (74, 77), (74, 79), (74, 84), (74, 85), (74, 87), (74, 89), (74, 96), (74, 98), (75, 98), (76, 98), (77, 98), (78, 98), (79, 98), (80, 98), (81, 98), (82, 98), (83, 98), (84, 98), (84, 97), (84, 94), (84, 90), (84, 87), (84, 82), (84, 81), (84, 77), (84, 75), (84, 72), (84, 64), (84, 61), (84, 60), (80, 59), (77, 59), (62, 59), (55, 59), (46, 59), (29, 62), (29, 65), (29, 69), (29, 85), (29, 96), (29, 97), (29, 100), (29, 104), (31, 111), (34, 111), (37, 111), (40, 111), (43, 111), (46, 111), (49, 111), (52, 111), (55, 111), (58, 111), (61, 111), (64, 111), (67, 111), (70, 111), (73, 111), (76, 111), (79, 111), (82, 111), (85, 111), (88, 111), (88, 109), (88, 96), (88, 95), (88, 94), (88, 93), (88, 91), (88, 87), (88, 83), (88, 79), (88, 77), (88, 75), (88, 64), (88, 61), (88, 60), (88, 55), (88, 47), (88, 45), (88, 44), (88, 37), (88, 32), (88, 28), (88, 26), (86, 26), (83, 26), (81, 26), (79, 26), (77, 26), (75, 26), (74, 26), (73, 26), (72, 26), (70, 26), (68, 26), (67, 26), (65, 26), (63, 26), (59, 26), (58, 26), (56, 26), (54, 26), (52, 26), (50, 26), (48, 26), (46, 26), (44, 26), (42, 26), (41, 26), (40, 26), (37, 26), (35, 26), (33, 26), (32, 26), (29, 26), (28, 26), (28, 27), (31, 25), (30, 24), (28, 24), (18, 47), (18, 49), (18, 53), (18, 66), (53, 76), (53, 71), (53, 68), (53, 65), (53, 62), (53, 61), (53, 58), (53, 57), (53, 55), (53, 52), (53, 47), (53, 40), (53, 34), (53, 31), (53, 25), (53, 23), (50, 22), (48, 22), (46, 22), (44, 22), (42, 22), (41, 22), (40, 22), (37, 22), (35, 22), (33, 22), (31, 22), (30, 22), (28, 22), (27, 22), (26, 22), (23, 22), (21, 22), (19, 22), (17, 22), (16, 22), (14, 22), (13, 22), (13, 23), (13, 44), (13, 47), (13, 49), (13, 52), (13, 66), (14, 67), (16, 67), (18, 67), (20, 67), (22, 67), (24, 67), (26, 67), (28, 67), (30, 67), (32, 67), (34, 67), (36, 67), (38, 67), (40, 67), (42, 67), (44, 67), (46, 67), (48, 67), (50, 67), (52, 67), (54, 67), (56, 67), (58, 67), (60, 67), (62, 67), (64, 67), (66, 67), (68, 67), (70, 67), (72, 67), (74, 67), (76, 67), (78, 67), (80, 67), (82, 67), (84, 67), (85, 66), (85, 65), (85, 61), (85, 60), (85, 58), (85, 56), (85, 55), (85, 45), (85, 44), (85, 37), (85, 33), (85, 32), (85, 28), (85, 26), (85, 25), (85, 20), (85, 18), (85, 13), (85, 10), (85, 9), (84, 7), (62, 7), (59, 7), (50, 9), (50, 10), (50, 14), (50, 20), (50, 23), (50, 25), (50, 27), (50, 32), (50, 33), (50, 35), (50, 36), (50, 42), (50, 44), (50, 49), (50, 52), (50, 54), (50, 55), (52, 55), (55, 55), (58, 55), (61, 55), (64, 55), (67, 55), (70, 55), (73, 55), (76, 55), (79, 55), (82, 55), (85, 55), (86, 47), (86, 45), (86, 44), (86, 37), (86, 33), (86, 32), (86, 28), (86, 26), (86, 25), (86, 20), (84, 20), (83, 20), (52, 20), (46, 23), (46, 25), (46, 27), (46, 32), (46, 33), (46, 36), (46, 42), (46, 44), (46, 49), (46, 51), (46, 54), (46, 55), (46, 56), (46, 57), (46, 59), (46, 60), (46, 61), (46, 63), (46, 64), (46, 68), (46, 70), (46, 76), (46, 85), (49, 90), (52, 90), (55, 90), (58, 90), (61, 90), (64, 90), (67, 90), (70, 90), (73, 90), (76, 90), (79, 90), (82, 90), (85, 90), (88, 90), (91, 90), (94, 90), (96, 89), (96, 88), (96, 82), (96, 74), (96, 64), (96, 61), (96, 60), (96, 58), (96, 57), (96, 55), (96, 53), (96, 50), (96, 49), (96, 45), (96, 44), (96, 37), (96, 31), (96, 30), (96, 28), (65, 28), (52, 28), (43, 32), (43, 33), (43, 36), (43, 42), (43, 44), (43, 49), (93, 45), (93, 44), (93, 37), (93, 32), (93, 31), (93, 30), (93, 28), (93, 27), (93, 22), (93, 19), (84, 15), (78, 15), (75, 15), (73, 15), (63, 15), (59, 15), (59, 17), (59, 18), (61, 18), (62, 18), (64, 18), (65, 18), (67, 18), (68, 18), (70, 18), (71, 18), (73, 18), (74, 18), (76, 18), (77, 18), (79, 18), (80, 18), (82, 18), (83, 18), (85, 18), (86, 18), (88, 18), (89, 18), (91, 18), (92, 18), (94, 18), (95, 18), (96, 17), (96, 6), (91, 8), (91, 16), (91, 18), (91, 19), (91, 21), (91, 24), (91, 25), (91, 28), (91, 29), (91, 32), (91, 37), (91, 45), (91, 46), (91, 47), (91, 49), (91, 50), (92, 54), (93, 54), (94, 54), (95, 54), (96, 54), (97, 54), (98, 54), (99, 54), (100, 54), (101, 54), (102, 54), (103, 54), (104, 54), (105, 54), (106, 54), (107, 54), (108, 54), (109, 54), (110, 54), (111, 54), (112, 54), (112, 53), (112, 50), (112, 47), (112, 45), (112, 32), (112, 25), (112, 20), (112, 19), (107, 18), (105, 20), (105, 21), (105, 29), (107, 30), (109, 30), (110, 29), (110, 25), (110, 20), (110, 19), (110, 17), (110, 16), (104, 9), (90, 9), (84, 9), (78, 9), (75, 9), (73, 9), (71, 9), (67, 9), (65, 12), (65, 13), (65, 16), (65, 17), (65, 18), (65, 19), (65, 21), (65, 22), (65, 25), (65, 26), (65, 27), (65, 29), (65, 32), (65, 35), (65, 36), (65, 42), (68, 43), (71, 43), (74, 43), (77, 43), (80, 43), (83, 43), (86, 43), (89, 43), (92, 43), (95, 43), (98, 43), (101, 43), (106, 43), (109, 43), (112, 43), (115, 43), (118, 43), (116, 37), (107, 37), (99, 37), (96, 37), (93, 37), (91, 37), (90, 37), (88, 37), (84, 37), (80, 37), (77, 37), (74, 37), (73, 37), (68, 37), (62, 42), (62, 49), (62, 50), (62, 51), (62, 54), (62, 55), (62, 56), (62, 57), (62, 60), (62, 63), (62, 64), (62, 65), (62, 66), (62, 67), (62, 68), (62, 72), (62, 73), (62, 74), (62, 75), (62, 77), (62, 78), (63, 80), (64, 80), (66, 80), (68, 80), (70, 80), (71, 80), (73, 80), (75, 80), (77, 80), (79, 80), (80, 79), (80, 77), (80, 75), (80, 73), (80, 72), (80, 66), (80, 65), (80, 64), (80, 63), (80, 61), (80, 60), (80, 59), (80, 58), (80, 56), (80, 54), (80, 53), (80, 48), (80, 45), (80, 44), (80, 42), (80, 41), (80, 37), (80, 36), (80, 35), (80, 34), (80, 33), (80, 32), (80, 31), (80, 30), (80, 28), (80, 27), (80, 25), (80, 24), (80, 23), (80, 20), (80, 19), (80, 18), (80, 17), (79, 17), (78, 17), (77, 17), (76, 17), (75, 17), (74, 17), (73, 17), (72, 17), (71, 17), (70, 17), (69, 17), (68, 17), (67, 17), (66, 17), (65, 17), (64, 17), (63, 17), (62, 17), (61, 17), (59, 17), (58, 17), (57, 17), (56, 17), (55, 17), (54, 17), (53, 17), (52, 17), (51, 17), (50, 17), (49, 17), (48, 17), (47, 17), (46, 17), (45, 17), (44, 17), (43, 17), (42, 17), (41, 17), (40, 17), (39, 17), (38, 17), (37, 17), (36, 17), (35, 17), (34, 17), (33, 17), (32, 17), (31, 17), (30, 17), (29, 17), (28, 17), (27, 17), (26, 17), (25, 17), (24, 17), (23, 17), (22, 17), (22, 18), (22, 19), (22, 23), (22, 25), (22, 29), (22, 31), (22, 32), (22, 34), (22, 44), (22, 47), (22, 49), (22, 52), (22, 53), (22, 54), (22, 57), (22, 62), (22, 63), (22, 66), (22, 68), (22, 70), (22, 75), (22, 83), (89, 85), (89, 83), (89, 82), (89, 79), (89, 77), (89, 75), (89, 72), (89, 64), (89, 61), (87, 61), (41, 64), (41, 65), (41, 66), (41, 68), (41, 70), (41, 76), (41, 82), (41, 83), (41, 90), (41, 91), (41, 92), (41, 96), (41, 98), (41, 99), (41, 100), (43, 101), (44, 101), (45, 101), (46, 101), (47, 101), (48, 101), (49, 101), (50, 101), (51, 101), (52, 101), (53, 101), (54, 101), (55, 101), (56, 101), (57, 101), (58, 101), (59, 101), (60, 101), (61, 101), (62, 101), (63, 101), (64, 101), (65, 101), (66, 101), (67, 101), (68, 101), (69, 101), (69, 100), (69, 97), (69, 94), (69, 91), (69, 89), (69, 87), (69, 85), (69, 83), (69, 81), (69, 80), (69, 77), (69, 75), (69, 73), (69, 72), (69, 71), (69, 66), (67, 66), (65, 66), (62, 66), (61, 66), (60, 66), (59, 66), (58, 66), (57, 66), (56, 66), (55, 66), (53, 66), (51, 66), (50, 66), (49, 66), (48, 66), (48, 67), (48, 68), (48, 70), (48, 76), (48, 83), (48, 90), (48, 91), (48, 92), (48, 93), (48, 96), (48, 98), (48, 99), (48, 100), (49, 102), (50, 102), (51, 102), (52, 102), (53, 102), (54, 102), (55, 102), (56, 102), (57, 102), (58, 102), (59, 102), (60, 102), (61, 102), (62, 102), (63, 102), (64, 102), (65, 102), (66, 102), (67, 102), (68, 102), (69, 102), (70, 102), (71, 102), (72, 102), (73, 102), (74, 102), (75, 102), (76, 102), (77, 102), (78, 102), (79, 102), (80, 102), (81, 102), (82, 102), (83, 102), (84, 102), (85, 102), (86, 102), (87, 102), (88, 102), (89, 102), (90, 102), (91, 102), (91, 101), (91, 100), (91, 99), (91, 98), (91, 97), (91, 94), (91, 89), (91, 88), (91, 85), (89, 85), (87, 85), (86, 85), (83, 85), (82, 85), (81, 85), (80, 85), (79, 85), (74, 85), (73, 85), (71, 85), (65, 85), (62, 85), (55, 85), (54, 85), (53, 85), (52, 85), (51, 85), (49, 85), (48, 85), (47, 85), (40, 85), (37, 85), (35, 85), (34, 85), (33, 85), (30, 85), (28, 85), (26, 85), (21, 85), (18, 85), (17, 85), (16, 98), (16, 101), (16, 104), (18, 107), (19, 107), (21, 107), (22, 107), (24, 107), (25, 107), (27, 107), (28, 107), (30, 107), (31, 107), (33, 107), (34, 107), (36, 107), (37, 107), (39, 107), (40, 107), (42, 107), (43, 107), (45, 107), (46, 107), (48, 107), (49, 107), (51, 107), (52, 107), (54, 107), (55, 107), (57, 107), (58, 107), (60, 107), (61, 107), (63, 107), (64, 107), (66, 107), (67, 107), (69, 107), (70, 107), (72, 107), (73, 107), (75, 107), (76, 107), (77, 106), (77, 103), (77, 102), (77, 101), (77, 100), (77, 99), (77, 98), (77, 95), (77, 94), (77, 90), (77, 87), (77, 85), (77, 84), (77, 82), (77, 81), (77, 79), (77, 77), (77, 75), (77, 73), (77, 72), (77, 70), (77, 69), (77, 66), (77, 65), (77, 64), (77, 63), (77, 61), (77, 60), (77, 59), (77, 58), (77, 56), (77, 54), (77, 53), (77, 48), (77, 45), (77, 44), (77, 42), (77, 41), (77, 37), (77, 36), (77, 35), (77, 34), (77, 33), (77, 32), (76, 32), (75, 32), (74, 32), (73, 32), (72, 32), (71, 32), (69, 32), (68, 32), (65, 32), (64, 32), (63, 32), (59, 32), (58, 32), (57, 32), (56, 32), (55, 33), (55, 35), (55, 36), (55, 40), (55, 42), (55, 44), (55, 48), (55, 49), (55, 52), (55, 54), (55, 55), (55, 56), (55, 57), (55, 60), (55, 61), (55, 62), (55, 63), (55, 64), (55, 65), (55, 66), (55, 67), (55, 68), (58, 68), (61, 68), (64, 68), (67, 68), (70, 68), (73, 68), (76, 68), (79, 68), (82, 68), (85, 68), (88, 68), (91, 68), (94, 68), (97, 68), (100, 68), (103, 68), (103, 65), (103, 64), (103, 63), (103, 61), (103, 60), (103, 59), (103, 55), (103, 53), (103, 51), (103, 50), (103, 49), (103, 48), (103, 47), (103, 46), (103, 45), (103, 41), (103, 38), (103, 36), (103, 35), (103, 32), (103, 27), (103, 25), (103, 20), (103, 19), (103, 18), (103, 17), (103, 16), (100, 13), (99, 13), (97, 13), (95, 13), (90, 13), (88, 13), (86, 13), (84, 13), (82, 13), (80, 13), (78, 13), (75, 13), (73, 13), (71, 13), (67, 13), (65, 13), (64, 13), (59, 13), (56, 13), (55, 13), (53, 13), (52, 15), (52, 17), (52, 18), (52, 20), (52, 21), (52, 23), (52, 25), (52, 26), (52, 27), (52, 29), (52, 31), (52, 33), (52, 34), (52, 35), (52, 36), (52, 40), (52, 42), (52, 44), (52, 48), (52, 49), (52, 52), (52, 54), (52, 55), (52, 56), (53, 56), (54, 56), (55, 56), (56, 56), (57, 56), (58, 56), (59, 56), (60, 56), (61, 56), (62, 56), (63, 56), (64, 56), (65, 56), (66, 56), (67, 56), (68, 56), (69, 56), (70, 56), (71, 56), (72, 56), (73, 56), (74, 56), (75, 56), (76, 56), (77, 56), (78, 56), (79, 56), (80, 56), (81, 56), (82, 56), (83, 56), (84, 56), (85, 56), (86, 56), (87, 56), (88, 56), (89, 56), (90, 56), (91, 56), (92, 56), (93, 56), (94, 56), (95, 56), (96, 56), (97, 56), (98, 56), (99, 56), (100, 56), (101, 56), (101, 55), (101, 53), (101, 51), (101, 50), (101, 49), (101, 48), (101, 47), (101, 46), (101, 45), (99, 45), (98, 45), (95, 45), (94, 45), (93, 45), (92, 45), (91, 45), (90, 45), (89, 45), (88, 45), (87, 45), (86, 45), (85, 45), (84, 45), (83, 45), (82, 45), (81, 45), (80, 45), (78, 45), (77, 45), (76, 45), (75, 45), (74, 45), (73, 45), (72, 45), (71, 45), (70, 45), (69, 45), (67, 45), (65, 45), (64, 45), (63, 45), (61, 45), (60, 45), (59, 45), (58, 45), (57, 45), (56, 45), (54, 45), (53, 45), (50, 45), (49, 45), (48, 45), (47, 45), (46, 45), (45, 45), (44, 45), (43, 45), (41, 45), (40, 45), (39, 45), (38, 45), (37, 45), (36, 45), (35, 45), (33, 45), (32, 45), (29, 45), (28, 45), (27, 45), (23, 45), (22, 45), (21, 45), (20, 45), (17, 45), (16, 45), (14, 45), (12, 45), (11, 45), (9, 46), (9, 49), (9, 52), (9, 64), (9, 68), (9, 75), (9, 85), (9, 101), (9, 104), (9, 108), (45, 111), (45, 109), (45, 107), (45, 103), (45, 101), (45, 99), (45, 96), (45, 94), (45, 91), (45, 90), (45, 89), (45, 84), (45, 83), (45, 79), (45, 78), (45, 74), (45, 73), (45, 70), (45, 68), (45, 67), (43, 65), (41, 65), (40, 65), (39, 65), (37, 65), (35, 65), (33, 65), (32, 65), (31, 65), (30, 65), (29, 65), (28, 65), (26, 65), (25, 65), (24, 65), (22, 65), (20, 65), (18, 65), (16, 65), (12, 65), (12, 66), (12, 68), (12, 73), (12, 83), (12, 86), (97, 91), (95, 91), (91, 91), (90, 91), (88, 91), (85, 91), (82, 91), (80, 91), (79, 91), (79, 96), (79, 97), (79, 99), (79, 100), (79, 101), (79, 102), (79, 103), (79, 104), (79, 105), (79, 107), (79, 108), (79, 111), (79, 113), (79, 114), (79, 115), (79, 117), (113, 113), (113, 109), (113, 108), (113, 107), (113, 106), (113, 103), (113, 100), (113, 98), (110, 98), (108, 98), (106, 98), (104, 98), (99, 98), (99, 100), (99, 101), (99, 102), (99, 107), (99, 110), (99, 112), (99, 114), (101, 114), (102, 114), (103, 114), (104, 114), (105, 114), (106, 114), (107, 114), (108, 114), (109, 114), (110, 114), (111, 114), (112, 114), (113, 114), (114, 114), (115, 114), (116, 114), (117, 114), (118, 114), (119, 114), (119, 113), (119, 111), (119, 105), (119, 103), (119, 100), (119, 98), (119, 97), (119, 90), (119, 88), (119, 87), (119, 85), (119, 84), (119, 82), (119, 81), (119, 80), (119, 78), (119, 76), (119, 75), (117, 75), (116, 75), (115, 75), (114, 75), (113, 75), (112, 75), (111, 75), (110, 75), (109, 75), (108, 75), (107, 75), (106, 75), (105, 75), (104, 75), (103, 75), (102, 75), (101, 75), (100, 75), (99, 75), (98, 75), (97, 75), (96, 75), (95, 75), (94, 75), (93, 75), (92, 75), (91, 75), (90, 75), (89, 75), (88, 75), (87, 75), (86, 75), (85, 75), (84, 75), (83, 75), (82, 75), (81, 75), (80, 75), (79, 75), (78, 75), (77, 75), (76, 75), (75, 75), (74, 75), (73, 75), (72, 75), (71, 75), (70, 75), (69, 75), (68, 75), (67, 75), (66, 75), (65, 75), (64, 75), (63, 75), (62, 75), (61, 75), (60, 75), (59, 75), (58, 75), (57, 75), (56, 75), (55, 75), (54, 75), (53, 75), (52, 75), (51, 75), (50, 75), (49, 75), (48, 75), (47, 75), (46, 75), (45, 75), (44, 75), (43, 75), (42, 75), (41, 75), (40, 75), (39, 75), (38, 75), (37, 75), (36, 75), (35, 75), (34, 75), (33, 75), (32, 75), (31, 75), (30, 75), (29, 75), (28, 75), (27, 75), (26, 75), (25, 75), (24, 75), (23, 75), (22, 75), (21, 75), (20, 75), (19, 75), (18, 75), (17, 75), (16, 75), (15, 75), (14, 75), (13, 75), (12, 75), (11, 75), (10, 75), (9, 75), (8, 75), (7, 75), (6, 75), (5, 75), (4, 75), (3, 75), (3, 76), (3, 85), (3, 101), (61, 115), (61, 113), (61, 112), (61, 111), (61, 109), (61, 107), (61, 102), (61, 101), (61, 100), (61, 96), (61, 94), (61, 90), (61, 89), (61, 88), (61, 85), (61, 84), (61, 83), (61, 82), (61, 81), (61, 79), (59, 78), (59, 79), (59, 80), (59, 81), (59, 83), (59, 84), (59, 85), (59, 86), (59, 87), (59, 89), (59, 91), (59, 92), (59, 96), (59, 97), (59, 98), (59, 101), (59, 102), (59, 103), (59, 104), (59, 107), (59, 108), (59, 110), (59, 111), (59, 113), (59, 114), (59, 115), (59, 117), (62, 122), (65, 122), (68, 122), (71, 122), (74, 122), (77, 122), (80, 122), (83, 122), (86, 122), (89, 122), (92, 122), (95, 122), (98, 122), (98, 118), (98, 116), (98, 113), (98, 112), (98, 110), (98, 109), (98, 107), (96, 107), (95, 107), (93, 107), (91, 107), (90, 107), (88, 107), (87, 108), (87, 109), (87, 110), (87, 111), (87, 114), (87, 115), (87, 117), (87, 122), (88, 125), (89, 125), (91, 125), (93, 125), (95, 125), (97, 125), (99, 125), (101, 125), (103, 125), (105, 125), (107, 125), (109, 125), (111, 125), (113, 125), (115, 125), (117, 125), (119, 125), (121, 125), (121, 121), (121, 115), (121, 110), (121, 107), (121, 106), (121, 103), (121, 100), (121, 98), (121, 97), (121, 96), (121, 90), (121, 88), (121, 87), (121, 85), (121, 84), (118, 84), (116, 84), (115, 84), (114, 85), (114, 86), (114, 88), (114, 89), (114, 92), (116, 95), (118, 95), (120, 95), (122, 95), (124, 95), (124, 90), (124, 88), (124, 87), (124, 85), (124, 84), (124, 83), (122, 84), (122, 85), (122, 86), (122, 89), (122, 92), (122, 94), (122, 96), (122, 97), (122, 99), (122, 100), (122, 103), (122, 106), (122, 109), (122, 110), (122, 111), (126, 113), (126, 110), (126, 107), (126, 106), (126, 103), (126, 100), (126, 97), (126, 96), (126, 94), (126, 93), (126, 92), (126, 91), (126, 90), (126, 88), (126, 87), (126, 85), (126, 84), (126, 83), (126, 82), (126, 80), (126, 79), (126, 77), (125, 77), (123, 77), (120, 77), (118, 77), (116, 77), (115, 77), (113, 77), (111, 77), (109, 77), (108, 77), (106, 77), (104, 77), (97, 77), (95, 77), (92, 77), (90, 77), (87, 77), (83, 77), (82, 77), (80, 77), (77, 77), (74, 77), (73, 77), (71, 77), (71, 79), (71, 81), (71, 84), (71, 85), (71, 86), (71, 87), (71, 89), (71, 90), (71, 91), (71, 92), (71, 96), (71, 97), (71, 98), (71, 99), (71, 101), (71, 102), (71, 103), (71, 104), (71, 105), (71, 106), (71, 108), (71, 109), (71, 111), (71, 114), (71, 115), (71, 117), (71, 118), (72, 118), (73, 118), (74, 118), (75, 118), (76, 118), (77, 118), (78, 118), (78, 117), (78, 116), (78, 113), (77, 109), (75, 109), (74, 109), (72, 109), (71, 109), (70, 109), (69, 109), (68, 109), (67, 109), (66, 109), (64, 109), (62, 109), (59, 109), (58, 109), (57, 109), (56, 109), (55, 109), (53, 109), (52, 109), (51, 109), (50, 109), (48, 109), (46, 109), (45, 109), (44, 110), (44, 112), (44, 115), (44, 117), (44, 123), (44, 124), (44, 127), (44, 128), (45, 128), (46, 128), (47, 128), (49, 128), (50, 128), (52, 128), (53, 128), (55, 128), (56, 128), (58, 128), (59, 128), (59, 126), (59, 125), (21, 128)]
# print(len(set(l)))